<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SAMSKRUTHI - INTERCOLLEGIATE FEST</title>
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap"></noscript>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="css/style.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js" defer></script>
</head>
<body>
  <canvas id="stars-canvas"></canvas>
  <div class="page-wrapper">
    <header>
      <div class="hamburger" id="hamburger">
        <div></div>
        <div></div>
        <div></div>
      </div>
      <nav id="navbar">
        <a href="index.html">Home</a>
        <a href="events.html">Events</a>
        <a href="registration.html">Registration</a>
        <a href="about.html">About Us</a>
        <a href="schedule.html">Schedule</a>
        <a href="contact.html">Contact Us</a>
      </nav>
    </header>
    <main class="content schedule">
      <div class="container">
        <h1>Event Schedule</h1>
        <div class="toggle-button">
          <div class="toggle-switch" onclick="toggleDay()">
            <div class="slider-indicator" id="sliderIndicator"></div>
            <span id="labelDay1">Day 1</span>
            <span id="labelDay2">Day 2</span>
          </div>
        </div>
        <div class="table-wrapper active" id="day1">
          <table class="schedule-table">
            <thead>
              <tr><th>Day</th><th>Event Name</th><th>Time</th><th>Venue</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
        <div class="table-wrapper" id="day2">
          <table class="schedule-table">
            <thead>
              <tr><th>Day</th><th>Event Name</th><th>Time</th><th>Venue</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </main>
    <footer>
      <div class="footer-left">
        <a href="https://www.instagram.com/samskruthi_official_2k25/" target="_blank" rel="noopener noreferrer">
          <i class="fab fa-instagram"></i> SAMSKRUTHI&nbsp;-&nbsp;Instagram
        </a>
        <a href="https://www.instagram.com/bmsccm_off/?hl=en" target="_blank" rel="noopener noreferrer">
          <i class="fab fa-instagram"></i> BMSCCM&nbsp;-&nbsp;Instagram
        </a>
        <a href="https://www.bmsccm.ac.in/" target="_blank" rel="noopener noreferrer">
          <i class="fas fa-globe"></i> BMSCCM Website
        </a>
      </div>
      <div class="footer-right">
        <iframe 
          src="https://maps.google.com/maps?q=bmsccm&output=embed" 
          allowfullscreen 
          loading="lazy" 
          referrerpolicy="no-referrer-when-downgrade">
        </iframe>
      </div>
    </footer>
    <div class="footer-credit">
      2025 SAMSKRUTHI | Made with ❤️ by Puneet Sethiya & Adithya K.P (6 BCA)
    </div>
  </div>
  <script src="js/script.js" defer></script>
  <script>
    function formatTime24to12(timeStr) {
      if (!timeStr) return '';
      const [h, m] = timeStr.split(':');
      let hour = parseInt(h, 10);
      const ampm = hour >= 12 ? 'PM' : 'AM';
      hour = hour % 12 || 12;
      return `${hour}:${m} ${ampm}`;
    }

    function extractDateTimeParts(dateTimeStr) {
      // Expects: YYYY-MM-DD-HH:MM-HH:MM
      if (!dateTimeStr) return { date: '', start: '', end: '' };
      const parts = dateTimeStr.split('-');
      if (parts.length < 5) return { date: '', start: '', end: '' };
      return {
        date: parts[0] + '-' + parts[1] + '-' + parts[2],
        start: parts[3],
        end: parts[4]
      };
    }

    function getSortableDateTime(dateTimeStr) {
      // Returns a Date object for sorting
      const parts = extractDateTimeParts(dateTimeStr);
      if (!parts.date || !parts.start) return new Date(0);
      return new Date(`${parts.date}T${parts.start}`);
    }

    async function loadSchedule() {
      const response = await fetch(`${window.location.origin}/api/events/schedule`);
      let schedule = await response.json();

      // Sort by date and start time
      schedule.sort((a, b) => getSortableDateTime(a.dateTime) - getSortableDateTime(b.dateTime));

      const day1Table = document.getElementById('day1').querySelector('tbody');
      const day2Table = document.getElementById('day2').querySelector('tbody');
      day1Table.innerHTML = '';
      day2Table.innerHTML = '';

      schedule.forEach(event => {
        const { start, end } = extractDateTimeParts(event.dateTime);
        const time = start && end ? `${formatTime24to12(start)} - ${formatTime24to12(end)}` : 'N/A';
        const row = `
          <tr>
            <td>${event.day || 'N/A'}</td>
            <td>${event.title || 'Untitled Event'}</td>
            <td>${time}</td>
            <td>${event.venue || 'TBD'}</td>
          </tr>
        `;
        if (event.day === 'Day 1') {
          day1Table.innerHTML += row;
        } else if (event.day === 'Day 2') {
          day2Table.innerHTML += row;
        }
      });
    }
    document.addEventListener('DOMContentLoaded', loadSchedule);

    // Toggle Day Switch (UI only)
    function toggleDay() {
      const day1 = document.getElementById('day1');
      const day2 = document.getElementById('day2');
      const slider = document.getElementById('sliderIndicator');
      if (day1.classList.contains('active')) {
        day1.classList.remove('active');
        day2.classList.add('active');
        slider.style.transform = 'translateX(100%)';
      } else {
        day2.classList.remove('active');
        day1.classList.add('active');
        slider.style.transform = 'translateX(0)';
      }
    }
  </script>
</body>
</html>
